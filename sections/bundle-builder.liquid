{% comment %}
  Bundle Builder Section
{% endcomment %}

<section class="bbn section-{{ section.id }}" data-step="1">
  <h2 class="bbn-step-title">Step 1: Choose Your Bundle</h2>

  <div class="bbn-bundles">
    {% for block in section.blocks %}
      <div class="bbn-bundle{% if forloop.first %} is-active{% endif %}">
        <div class="bbn-bundle__label-top">
          {{ block.settings.label_top }}
        </div>

        <div class="bbn-bundle__body">
          <div class="bbn-bundle__image">
            {% if block.settings.image %}
              <img src="{{ block.settings.image | img_url: '300x' }}" alt="">
            {% endif %}
          </div>

          <div class="bbn-bundle__title">
            {{ block.settings.size }} {{ section.settings.bundle_title }}
          </div>

          <div class="bbn-bundle__prices">
            {% if block.settings.compare_each > 0 %}
              <span class="bbn-bundle__compare">
                {{ block.settings.compare_each | money }}
              </span>
            {% endif %}
            <span class="bbn-bundle__real">
              {{ block.settings.price_each | money }} each
            </span>
          </div>
        </div>

        <div class="bbn-bundle__label-bottom">
          {{ block.settings.label_bottom }}
        </div>
      </div>
    {% endfor %}
  </div>

  <button class="bbn-btn bbn-btn--primary bbn-btn--full">
    Next: Choose Your Colors
  </button>
</section>

<!-- Fonts + Styling -->
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700;800&display=swap" rel="stylesheet">

<style>
section.bbn.section-{{ section.id }} *{ font-family:'Poppins',sans-serif !important; }
section.bbn.section-{{ section.id }}{
  --bbn-blue:#2F53FF; --bbn-aqua:#D9F7FF;
  --bbn-text:#111827; --bbn-muted:#6B7280; --bbn-border:#D2D6E0;
}

/* Grid: 3 across always (2 on very tiny) */
section.bbn.section-{{ section.id }} .bbn-bundles{
  display:grid; gap:12px;
  grid-template-columns:repeat(3,1fr);
}
@media(max-width:360px){
  section.bbn.section-{{ section.id }} .bbn-bundles{ grid-template-columns:repeat(2,1fr); }
}

/* Card */
section.bbn.section-{{ section.id }} .bbn-bundle{
  border:1.5px solid var(--bbn-border);
  border-radius:16px; background:#fff;
  display:flex; flex-direction:column;
  min-height:460px;
  box-shadow:0 2px 0 rgba(0,0,0,.06);
}
section.bbn.section-{{ section.id }} .bbn-bundle.is-active{
  box-shadow: inset 0 0 0 3px var(--bbn-blue);
}
section.bbn.section-{{ section.id }} .bbn-bundle.is-active .bbn-bundle__body{
  background:var(--bbn-aqua);
}

/* Top ribbon */
section.bbn.section-{{ section.id }} .bbn-bundle__label-top{
  background:var(--bbn-blue); color:#fff;
  font-weight:800; text-align:center; font-size:13px;
  padding:10px 8px; min-height:56px;
  display:flex; align-items:center; justify-content:center;
}

/* Body slots */
section.bbn.section-{{ section.id }} .bbn-bundle__body{
  flex:1 1 auto; display:flex; flex-direction:column;
  padding:12px 12px 0;
}
section.bbn.section-{{ section.id }} .bbn-bundle__image{
  flex:0 0 160px; display:flex; align-items:center; justify-content:center;
}
section.bbn.section-{{ section.id }} .bbn-bundle__image img{
  width:150px; height:150px; object-fit:contain;
}
section.bbn.section-{{ section.id }} .bbn-bundle__title{
  text-align:center; font-weight:800; font-size:18px; margin:6px 0 2px;
  min-height:44px; display:flex; align-items:center; justify-content:center;
}
section.bbn.section-{{ section.id }} .bbn-bundle__prices{
  display:flex; justify-content:center; gap:8px; min-height:28px;
}
section.bbn.section-{{ section.id }} .bbn-bundle__compare{
  text-decoration:line-through; color:var(--bbn-muted); font-size:16px;
}
section.bbn.section-{{ section.id }} .bbn-bundle__real{
  font-weight:800; font-size:18px; color:var(--bbn-text);
}

/* Bottom ribbon pinned */
section.bbn.section-{{ section.id }} .bbn-bundle__label-bottom{
  background:var(--bbn-blue); color:#fff;
  font-weight:800; font-size:14px; text-align:center;
  padding:10px 12px; border-radius:12px;
  margin:10px 12px 12px; margin-top:auto;
}

/* CTA */
section.bbn.section-{{ section.id }} .bbn-btn{
  border-radius:16px; border:2px solid var(--bbn-blue);
  font-weight:800; padding:14px 16px; margin-top:20px;
}
section.bbn.section-{{ section.id }} .bbn-btn--primary{ background:var(--bbn-blue); color:#fff; }
section.bbn.section-{{ section.id }} .bbn-btn--full{ width:100%; }
</style>

{% schema %}
{
  "name": "Bundle Builder",
  "class": "bundle-builder",
  "settings": [
    { "type": "text", "id": "bundle_title", "label": "Bundle item name", "default": "Birdie 3.0" }
  ],
  "blocks": [
    {
      "type": "pack",
      "name": "Bundle pack",
      "settings": [
        { "type": "number", "id": "size", "label": "Pack size", "default": 1 },
        { "type": "text", "id": "label_top", "label": "Top label", "default": "Standard Price" },
        { "type": "number", "id": "price_each", "label": "Price per item", "default": 34 },
        { "type": "number", "id": "compare_each", "label": "Compare at", "default": 38 },
        { "type": "text", "id": "label_bottom", "label": "Bottom label", "default": "Save $3.8" },
        { "type": "image_picker", "id": "image", "label": "Pack image" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Bundle Builder",
      "blocks": [
        { "type": "pack" },
        { "type": "pack" },
        { "type": "pack" }
      ]
    }
  ]
}
{% endschema %}
