{% schema %}
{
  "name": "Customer Gallery Slider",
  "settings": [
    {
      "type": "text",
      "id": "headline",
      "label": "Headline",
      "default": "Customers love The Neutralizer!"
    },
    {
      "type": "range",
      "id": "headline_size",
      "label": "Headline Font Size",
      "default": 28,
      "min": 16,
      "max": 60,
      "step": 1,
      "unit": "px"
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background Color",
      "default": "#f8fafc"
    },
    {
      "type": "range",
      "id": "image_width",
      "label": "Image Width (px)",
      "default": 220,
      "min": 150,
      "max": 400,
      "step": 10,
      "unit": "px"
    },
    {
      "type": "range",
      "id": "image_radius",
      "label": "Image Corner Radius (px)",
      "default": 20,
      "min": 0,
      "max": 60,
      "step": 2,
      "unit": "px"
    }
  ],
  "blocks": [
    {
      "type": "image",
      "name": "Customer Image",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Customer Image"
        },
        {
          "type": "text",
          "id": "alt",
          "label": "Alt Text",
          "default": "Customer photo"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Customer Gallery Slider",
      "category": "Media"
    }
  ]
}
{% endschema %}

<section
  class="customer-gallery"
  style="background-color: {{ section.settings.background_color }};"
>
  <div class="customer-gallery__inner">
    <h2
      class="customer-gallery__headline"
      style="font-size: {{ section.settings.headline_size }}px;"
    >
      {{ section.settings.headline }}
    </h2>

    <div class="customer-gallery__slider">
      {% for block in section.blocks %}
        {% if block.settings.image != blank %}
          <div class="customer-gallery__slide">
            <img
              src="{{ block.settings.image | image_url: width: 800 }}"
              alt="{{ block.settings.alt | escape }}"
              style="border-radius: {{ section.settings.image_radius }}px; width: {{ section.settings.image_width }}px;"
              loading="lazy"
            >
          </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

<style>
  .customer-gallery {
    padding: 40px 0;
  }

  .customer-gallery__inner {
    max-width: 1200px;
    margin: 0 auto;
    text-align: center;
    overflow: hidden;
  }

  .customer-gallery__headline {
    font-weight: 700;
    margin-bottom: 25px;
  }

  .customer-gallery__slider {
    display: flex;
    gap: 16px;
    justify-content: center;
    align-items: center;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    -webkit-overflow-scrolling: touch;
    padding: 0 10px;
  }

  .customer-gallery__slide {
    flex: 0 0 auto;
    scroll-snap-align: center;
    transition: transform 0.3s ease;
  }

  .customer-gallery__slide:hover {
    transform: scale(1.03);
  }

  .customer-gallery__slide img {
    height: auto;
    object-fit: cover;
    display: block;
  }

  /* Hide scrollbar on WebKit */
  .customer-gallery__slider::-webkit-scrollbar {
    display: none;
  }
</style>

<script>
  // Optional: simple auto-scroll
  document.addEventListener('DOMContentLoaded', () => {
    const slider = document.querySelector('.customer-gallery__slider');
    if (!slider) return;

    let scrollAmount = 0;
    setInterval(() => {
      if (slider.scrollWidth - slider.clientWidth <= scrollAmount) {
        scrollAmount = 0;
      } else {
        scrollAmount += 240;
      }
      slider.scrollTo({ left: scrollAmount, behavior: 'smooth' });
    }, 1000);
  });
</script>
